use crate::{Joint, JointPos, JointScale, JointSide};
use ratatui::buffer::Buffer;
use ratatui::layout::{Position, Rect};
use ratatui::widgets::BorderType;

pub fn render_joint(border: BorderType, mut joint: Joint, area: Rect, buf: &mut Buffer) {
    // normalize before finding the glyph
    let n_pos = match joint.side {
        JointSide::Top | JointSide::Bottom => match joint.pos {
            JointPos::ProlongStart => 0,
            JointPos::Start => 0,
            JointPos::Pos(n) => {
                if n == 0 {
                    joint.pos = JointPos::Start;
                } else if n == area.width - 1 {
                    joint.pos = JointPos::End;
                }
                n
            }
            JointPos::End => area.width - 1,
            JointPos::ProlongEnd => area.width - 1,
        },
        JointSide::Right | JointSide::Left => match joint.pos {
            JointPos::ProlongStart => 0,
            JointPos::Start => 0,
            JointPos::Pos(n) => {
                if n == 0 {
                    joint.pos = JointPos::Start;
                } else if n == area.height - 1 {
                    joint.pos = JointPos::End;
                }
                n
            }
            JointPos::End => area.height - 1,
            JointPos::ProlongEnd => area.height - 1,
        },
    };

    let sym = match border {
        BorderType::Plain => plain_joint(joint),
        BorderType::Rounded => plain_joint(joint),
        BorderType::Double => double_joint(joint),
        BorderType::Thick => thick_joint(joint),
        BorderType::QuadrantInside => quad_inside_joint(joint),
        BorderType::QuadrantOutside => "X",
    };

    match joint.side {
        JointSide::Top => {
            if let Some(cell) = buf.cell_mut(Position::new(area.left() + n_pos, area.top())) {
                cell.set_symbol(sym);
            }
        }
        JointSide::Right => {
            if let Some(cell) = buf.cell_mut(Position::new(
                area.right().saturating_sub(1),
                area.top() + n_pos,
            )) {
                cell.set_symbol(sym);
            }
        }
        JointSide::Bottom => {
            if let Some(cell) = buf.cell_mut(Position::new(
                area.left() + n_pos,
                area.bottom().saturating_sub(1),
            )) {
                cell.set_symbol(sym);
            }
        }
        JointSide::Left => {
            if let Some(cell) = buf.cell_mut(Position::new(area.left(), area.top() + n_pos)) {
                cell.set_symbol(sym);
            }
        }
    }
}

fn plain_joint(joint: Joint) -> &'static str {
    use BorderType::*;
    use JointPos::*;
    use JointScale::*;
    use JointSide::*;

    match (joint.scale, joint.side, joint.pos, joint.border) {
        (Out, Top, ProlongStart, Plain) => "┬",
        (Out, Top, ProlongStart, Rounded) => "┬",
        (Out, Top, ProlongStart, Double) => "┬",
        (Out, Top, ProlongStart, Thick) => "┭",
        (Out, Top, ProlongStart, QuadrantInside) => "┬",
        (Out, Top, ProlongStart, QuadrantOutside) => "┬",
        (Out, Top, Start, Plain) => "├",
        (Out, Top, Start, Rounded) => "├",
        (Out, Top, Start, Double) => "├",
        (Out, Top, Start, Thick) => "┞",
        (Out, Top, Start, QuadrantInside) => "├",
        (Out, Top, Start, QuadrantOutside) => "├",
        (Out, Top, Pos(_), Plain) => "┴",
        (Out, Top, Pos(_), Rounded) => "┴",
        (Out, Top, Pos(_), Double) => "╨",
        (Out, Top, Pos(_), Thick) => "┸",
        (Out, Top, Pos(_), QuadrantInside) => "┴",
        (Out, Top, Pos(_), QuadrantOutside) => "┴",
        (Out, Top, End, Plain) => "┤",
        (Out, Top, End, Rounded) => "┤",
        (Out, Top, End, Double) => "┤",
        (Out, Top, End, Thick) => "┦",
        (Out, Top, End, QuadrantInside) => "┤",
        (Out, Top, End, QuadrantOutside) => "┤",
        (Out, Top, ProlongEnd, Plain) => "┬",
        (Out, Top, ProlongEnd, Rounded) => "┬",
        (Out, Top, ProlongEnd, Double) => "┬",
        (Out, Top, ProlongEnd, Thick) => "┮",
        (Out, Top, ProlongEnd, QuadrantInside) => "┬",
        (Out, Top, ProlongEnd, QuadrantOutside) => "┬",

        (Out, Right, ProlongStart, Plain) => "┤",
        (Out, Right, ProlongStart, Rounded) => "┤",
        (Out, Right, ProlongStart, Double) => "┤",
        (Out, Right, ProlongStart, Thick) => "┦",
        (Out, Right, ProlongStart, QuadrantInside) => "┤",
        (Out, Right, ProlongStart, QuadrantOutside) => "┤",
        (Out, Right, Start, Plain) => "┬",
        (Out, Right, Start, Rounded) => "┬",
        (Out, Right, Start, Double) => "┬",
        (Out, Right, Start, Thick) => "┮",
        (Out, Right, Start, QuadrantInside) => "┬",
        (Out, Right, Start, QuadrantOutside) => "┬",
        (Out, Right, Pos(_), Plain) => "├",
        (Out, Right, Pos(_), Double) => "╞",
        (Out, Right, Pos(_), Thick) => "┝",
        (Out, Right, Pos(_), QuadrantInside) => "├",
        (Out, Right, Pos(_), QuadrantOutside) => "├",
        (Out, Right, Pos(_), Rounded) => "├",
        (Out, Right, End, Plain) => "┴",
        (Out, Right, End, Rounded) => "┴",
        (Out, Right, End, Double) => "┴",
        (Out, Right, End, Thick) => "┶",
        (Out, Right, End, QuadrantInside) => "┴",
        (Out, Right, End, QuadrantOutside) => "┴",
        (Out, Right, ProlongEnd, Plain) => "┤",
        (Out, Right, ProlongEnd, Rounded) => "┤",
        (Out, Right, ProlongEnd, Double) => "┤",
        (Out, Right, ProlongEnd, Thick) => "┧",
        (Out, Right, ProlongEnd, QuadrantInside) => "┤",
        (Out, Right, ProlongEnd, QuadrantOutside) => "┤",

        (Out, Bottom, ProlongStart, Plain) => "┴",
        (Out, Bottom, ProlongStart, Rounded) => "┴",
        (Out, Bottom, ProlongStart, Double) => "┴",
        (Out, Bottom, ProlongStart, Thick) => "┵",
        (Out, Bottom, ProlongStart, QuadrantInside) => "┴",
        (Out, Bottom, ProlongStart, QuadrantOutside) => "┴",
        (Out, Bottom, Start, Plain) => "├",
        (Out, Bottom, Start, Rounded) => "├",
        (Out, Bottom, Start, Double) => "├",
        (Out, Bottom, Start, Thick) => "┟",
        (Out, Bottom, Start, QuadrantInside) => "├",
        (Out, Bottom, Start, QuadrantOutside) => "├",
        (Out, Bottom, Pos(_), Plain) => "┬",
        (Out, Bottom, Pos(_), Rounded) => "┬",
        (Out, Bottom, Pos(_), Double) => "╥",
        (Out, Bottom, Pos(_), Thick) => "┰",
        (Out, Bottom, Pos(_), QuadrantInside) => "┬",
        (Out, Bottom, Pos(_), QuadrantOutside) => "┬",
        (Out, Bottom, End, Plain) => "┤",
        (Out, Bottom, End, Rounded) => "┤",
        (Out, Bottom, End, Double) => "┤",
        (Out, Bottom, End, Thick) => "┧",
        (Out, Bottom, End, QuadrantInside) => "┤",
        (Out, Bottom, End, QuadrantOutside) => "┤",
        (Out, Bottom, ProlongEnd, Plain) => "┴",
        (Out, Bottom, ProlongEnd, Rounded) => "┴",
        (Out, Bottom, ProlongEnd, Double) => "┴",
        (Out, Bottom, ProlongEnd, Thick) => "┶",
        (Out, Bottom, ProlongEnd, QuadrantInside) => "┴",
        (Out, Bottom, ProlongEnd, QuadrantOutside) => "┴",

        (Out, Left, ProlongStart, Plain) => "├",
        (Out, Left, ProlongStart, Rounded) => "├",
        (Out, Left, ProlongStart, Double) => "├",
        (Out, Left, ProlongStart, Thick) => "┞",
        (Out, Left, ProlongStart, QuadrantInside) => "├",
        (Out, Left, ProlongStart, QuadrantOutside) => "├",
        (Out, Left, Start, Plain) => "┬",
        (Out, Left, Start, Rounded) => "┬",
        (Out, Left, Start, Double) => "┬",
        (Out, Left, Start, Thick) => "┭",
        (Out, Left, Start, QuadrantInside) => "┬",
        (Out, Left, Start, QuadrantOutside) => "┬",
        (Out, Left, Pos(_), Plain) => "┤",
        (Out, Left, Pos(_), Rounded) => "┤",
        (Out, Left, Pos(_), Double) => "╡",
        (Out, Left, Pos(_), Thick) => "┥",
        (Out, Left, Pos(_), QuadrantInside) => "┤",
        (Out, Left, Pos(_), QuadrantOutside) => "┤",
        (Out, Left, End, Plain) => "┴",
        (Out, Left, End, Rounded) => "┴",
        (Out, Left, End, Double) => "┴",
        (Out, Left, End, Thick) => "┵",
        (Out, Left, End, QuadrantInside) => "┴",
        (Out, Left, End, QuadrantOutside) => "┴",
        (Out, Left, ProlongEnd, Plain) => "├",
        (Out, Left, ProlongEnd, Rounded) => "├",
        (Out, Left, ProlongEnd, Double) => "├",
        (Out, Left, ProlongEnd, Thick) => "┟",
        (Out, Left, ProlongEnd, QuadrantInside) => "├",
        (Out, Left, ProlongEnd, QuadrantOutside) => "├",

        // -------------------------------------------------
        (In, Top, ProlongStart, Plain) => "┌",
        (In, Top, ProlongStart, Rounded) => "┌",
        (In, Top, ProlongStart, Double) => "┌",
        (In, Top, ProlongStart, Thick) => "┌",
        (In, Top, ProlongStart, QuadrantInside) => "┌",
        (In, Top, ProlongStart, QuadrantOutside) => "┌",
        (In, Top, Start, Plain) => "┌",
        (In, Top, Start, Rounded) => "┌",
        (In, Top, Start, Double) => "┌",
        (In, Top, Start, Thick) => "┌",
        (In, Top, Start, QuadrantInside) => "┌",
        (In, Top, Start, QuadrantOutside) => "┌",
        (In, Top, Pos(_), Plain) => "┬",
        (In, Top, Pos(_), Rounded) => "┬",
        (In, Top, Pos(_), Double) => "╥",
        (In, Top, Pos(_), Thick) => "┰",
        (In, Top, Pos(_), QuadrantInside) => "┬",
        (In, Top, Pos(_), QuadrantOutside) => "┬",
        (In, Top, End, Plain) => "┐",
        (In, Top, End, Rounded) => "┐",
        (In, Top, End, Double) => "┐",
        (In, Top, End, Thick) => "┐",
        (In, Top, End, QuadrantInside) => "┐",
        (In, Top, End, QuadrantOutside) => "┐",
        (In, Top, ProlongEnd, Plain) => "┐",
        (In, Top, ProlongEnd, Rounded) => "┐",
        (In, Top, ProlongEnd, Double) => "┐",
        (In, Top, ProlongEnd, Thick) => "┐",
        (In, Top, ProlongEnd, QuadrantInside) => "┐",
        (In, Top, ProlongEnd, QuadrantOutside) => "┐",

        (In, Right, ProlongStart, Plain) => "┐",
        (In, Right, ProlongStart, Rounded) => "┐",
        (In, Right, ProlongStart, Double) => "┐",
        (In, Right, ProlongStart, Thick) => "┐",
        (In, Right, ProlongStart, QuadrantInside) => "┐",
        (In, Right, ProlongStart, QuadrantOutside) => "┐",
        (In, Right, Start, Plain) => "┐",
        (In, Right, Start, Rounded) => "┐",
        (In, Right, Start, Double) => "┐",
        (In, Right, Start, Thick) => "┐",
        (In, Right, Start, QuadrantInside) => "┐",
        (In, Right, Start, QuadrantOutside) => "┐",
        (In, Right, Pos(_), Plain) => "┤",
        (In, Right, Pos(_), Rounded) => "┤",
        (In, Right, Pos(_), Double) => "╡",
        (In, Right, Pos(_), Thick) => "┥",
        (In, Right, Pos(_), QuadrantInside) => "┤",
        (In, Right, Pos(_), QuadrantOutside) => "┤",
        (In, Right, End, Plain) => "┘",
        (In, Right, End, Rounded) => "┘",
        (In, Right, End, Double) => "┘",
        (In, Right, End, Thick) => "┘",
        (In, Right, End, QuadrantInside) => "┘",
        (In, Right, End, QuadrantOutside) => "┘",
        (In, Right, ProlongEnd, Plain) => "┘",
        (In, Right, ProlongEnd, Rounded) => "┘",
        (In, Right, ProlongEnd, Double) => "┘",
        (In, Right, ProlongEnd, Thick) => "┘",
        (In, Right, ProlongEnd, QuadrantInside) => "┘",
        (In, Right, ProlongEnd, QuadrantOutside) => "┘",

        (In, Bottom, ProlongStart, Plain) => "└",
        (In, Bottom, ProlongStart, Rounded) => "└",
        (In, Bottom, ProlongStart, Double) => "└",
        (In, Bottom, ProlongStart, Thick) => "└",
        (In, Bottom, ProlongStart, QuadrantInside) => "┘",
        (In, Bottom, ProlongStart, QuadrantOutside) => "┘",
        (In, Bottom, Start, Plain) => "└",
        (In, Bottom, Start, Rounded) => "└",
        (In, Bottom, Start, Double) => "└",
        (In, Bottom, Start, Thick) => "└",
        (In, Bottom, Start, QuadrantInside) => "┘",
        (In, Bottom, Start, QuadrantOutside) => "┘",
        (In, Bottom, Pos(_), Plain) => "┴",
        (In, Bottom, Pos(_), Rounded) => "┴",
        (In, Bottom, Pos(_), Double) => "╨",
        (In, Bottom, Pos(_), Thick) => "┸",
        (In, Bottom, Pos(_), QuadrantInside) => "┘",
        (In, Bottom, Pos(_), QuadrantOutside) => "┘",
        (In, Bottom, End, Plain) => "┘",
        (In, Bottom, End, Rounded) => "┘",
        (In, Bottom, End, Double) => "┘",
        (In, Bottom, End, Thick) => "┘",
        (In, Bottom, End, QuadrantInside) => "┘",
        (In, Bottom, End, QuadrantOutside) => "┘",
        (In, Bottom, ProlongEnd, Plain) => "┘",
        (In, Bottom, ProlongEnd, Rounded) => "┘",
        (In, Bottom, ProlongEnd, Double) => "┘",
        (In, Bottom, ProlongEnd, Thick) => "┘",
        (In, Bottom, ProlongEnd, QuadrantInside) => "┘",
        (In, Bottom, ProlongEnd, QuadrantOutside) => "┘",

        (In, Left, ProlongStart, Plain) => "┌",
        (In, Left, ProlongStart, Rounded) => "┌",
        (In, Left, ProlongStart, Double) => "┌",
        (In, Left, ProlongStart, Thick) => "┌",
        (In, Left, ProlongStart, QuadrantInside) => "┌",
        (In, Left, ProlongStart, QuadrantOutside) => "┌",
        (In, Left, Start, Plain) => "┌",
        (In, Left, Start, Rounded) => "┌",
        (In, Left, Start, Double) => "┌",
        (In, Left, Start, Thick) => "┌",
        (In, Left, Start, QuadrantInside) => "┌",
        (In, Left, Start, QuadrantOutside) => "┌",
        (In, Left, Pos(_), Plain) => "├",
        (In, Left, Pos(_), Rounded) => "├",
        (In, Left, Pos(_), Double) => "╞",
        (In, Left, Pos(_), Thick) => "┝",
        (In, Left, Pos(_), QuadrantInside) => "├",
        (In, Left, Pos(_), QuadrantOutside) => "├",
        (In, Left, End, Plain) => "└",
        (In, Left, End, Rounded) => "└",
        (In, Left, End, Double) => "└",
        (In, Left, End, Thick) => "└",
        (In, Left, End, QuadrantInside) => "└",
        (In, Left, End, QuadrantOutside) => "└",
        (In, Left, ProlongEnd, Plain) => "└",
        (In, Left, ProlongEnd, Rounded) => "└",
        (In, Left, ProlongEnd, Double) => "└",
        (In, Left, ProlongEnd, Thick) => "└",
        (In, Left, ProlongEnd, QuadrantInside) => "└",
        (In, Left, ProlongEnd, QuadrantOutside) => "└",

        // ----------------------------------------------
        (Through, Top, ProlongStart, Plain) => "┌",
        (Through, Top, ProlongStart, Rounded) => "┌",
        (Through, Top, ProlongStart, Double) => "┌",
        (Through, Top, ProlongStart, Thick) => "┌",
        (Through, Top, ProlongStart, QuadrantInside) => "┌",
        (Through, Top, ProlongStart, QuadrantOutside) => "┌",
        (Through, Top, Start, Plain) => "┌",
        (Through, Top, Start, Rounded) => "┌",
        (Through, Top, Start, Double) => "┌",
        (Through, Top, Start, Thick) => "┌",
        (Through, Top, Start, QuadrantInside) => "┌",
        (Through, Top, Start, QuadrantOutside) => "┌",
        (Through, Top, Pos(_), Plain) => "┼",
        (Through, Top, Pos(_), Rounded) => "┼",
        (Through, Top, Pos(_), Double) => "╫",
        (Through, Top, Pos(_), Thick) => "╂",
        (Through, Top, Pos(_), QuadrantInside) => "┼",
        (Through, Top, Pos(_), QuadrantOutside) => "┼",
        (Through, Top, End, Plain) => "┐",
        (Through, Top, End, Rounded) => "┐",
        (Through, Top, End, Double) => "┐",
        (Through, Top, End, Thick) => "┐",
        (Through, Top, End, QuadrantInside) => "┐",
        (Through, Top, End, QuadrantOutside) => "┐",
        (Through, Top, ProlongEnd, Plain) => "┐",
        (Through, Top, ProlongEnd, Rounded) => "┐",
        (Through, Top, ProlongEnd, Double) => "┐",
        (Through, Top, ProlongEnd, Thick) => "┐",
        (Through, Top, ProlongEnd, QuadrantInside) => "┐",
        (Through, Top, ProlongEnd, QuadrantOutside) => "┐",

        (Through, Right, ProlongStart, Plain) => "┐",
        (Through, Right, ProlongStart, Rounded) => "┐",
        (Through, Right, ProlongStart, Double) => "┐",
        (Through, Right, ProlongStart, Thick) => "┐",
        (Through, Right, ProlongStart, QuadrantInside) => "┐",
        (Through, Right, ProlongStart, QuadrantOutside) => "┐",
        (Through, Right, Start, Plain) => "┐",
        (Through, Right, Start, Rounded) => "┐",
        (Through, Right, Start, Double) => "┐",
        (Through, Right, Start, Thick) => "┐",
        (Through, Right, Start, QuadrantInside) => "┐",
        (Through, Right, Start, QuadrantOutside) => "┐",
        (Through, Right, Pos(_), Plain) => "┼",
        (Through, Right, Pos(_), Rounded) => "┼",
        (Through, Right, Pos(_), Double) => "╪",
        (Through, Right, Pos(_), Thick) => "┿",
        (Through, Right, Pos(_), QuadrantInside) => "┼",
        (Through, Right, Pos(_), QuadrantOutside) => "┼",
        (Through, Right, End, Plain) => "┘",
        (Through, Right, End, Rounded) => "┘",
        (Through, Right, End, Double) => "┘",
        (Through, Right, End, Thick) => "┘",
        (Through, Right, End, QuadrantInside) => "┘",
        (Through, Right, End, QuadrantOutside) => "┘",
        (Through, Right, ProlongEnd, Plain) => "┘",
        (Through, Right, ProlongEnd, Rounded) => "┘",
        (Through, Right, ProlongEnd, Double) => "┘",
        (Through, Right, ProlongEnd, Thick) => "┘",
        (Through, Right, ProlongEnd, QuadrantInside) => "┘",
        (Through, Right, ProlongEnd, QuadrantOutside) => "┘",

        (Through, Bottom, ProlongStart, Plain) => "└",
        (Through, Bottom, ProlongStart, Rounded) => "└",
        (Through, Bottom, ProlongStart, Double) => "└",
        (Through, Bottom, ProlongStart, Thick) => "└",
        (Through, Bottom, ProlongStart, QuadrantInside) => "└",
        (Through, Bottom, ProlongStart, QuadrantOutside) => "└",
        (Through, Bottom, Start, Plain) => "└",
        (Through, Bottom, Start, Rounded) => "└",
        (Through, Bottom, Start, Double) => "└",
        (Through, Bottom, Start, Thick) => "└",
        (Through, Bottom, Start, QuadrantInside) => "└",
        (Through, Bottom, Start, QuadrantOutside) => "└",
        (Through, Bottom, Pos(_), Plain) => "┼",
        (Through, Bottom, Pos(_), Rounded) => "┼",
        (Through, Bottom, Pos(_), Double) => "╫",
        (Through, Bottom, Pos(_), Thick) => "╂",
        (Through, Bottom, Pos(_), QuadrantInside) => "┼",
        (Through, Bottom, Pos(_), QuadrantOutside) => "┼",
        (Through, Bottom, End, Plain) => "┘",
        (Through, Bottom, End, Rounded) => "┘",
        (Through, Bottom, End, Double) => "┘",
        (Through, Bottom, End, Thick) => "┘",
        (Through, Bottom, End, QuadrantInside) => "┘",
        (Through, Bottom, End, QuadrantOutside) => "┘",
        (Through, Bottom, ProlongEnd, Plain) => "┘",
        (Through, Bottom, ProlongEnd, Rounded) => "┘",
        (Through, Bottom, ProlongEnd, Double) => "┘",
        (Through, Bottom, ProlongEnd, Thick) => "┘",
        (Through, Bottom, ProlongEnd, QuadrantInside) => "┘",
        (Through, Bottom, ProlongEnd, QuadrantOutside) => "┘",

        (Through, Left, ProlongStart, Plain) => "┌",
        (Through, Left, ProlongStart, Rounded) => "┌",
        (Through, Left, ProlongStart, Double) => "┌",
        (Through, Left, ProlongStart, Thick) => "┌",
        (Through, Left, ProlongStart, QuadrantInside) => "┌",
        (Through, Left, ProlongStart, QuadrantOutside) => "┌",
        (Through, Left, Start, Plain) => "┌",
        (Through, Left, Start, Rounded) => "┌",
        (Through, Left, Start, Double) => "┌",
        (Through, Left, Start, Thick) => "┌",
        (Through, Left, Start, QuadrantInside) => "┌",
        (Through, Left, Start, QuadrantOutside) => "┌",
        (Through, Left, Pos(_), Plain) => "┼",
        (Through, Left, Pos(_), Rounded) => "┼",
        (Through, Left, Pos(_), Double) => "╪",
        (Through, Left, Pos(_), Thick) => "┿",
        (Through, Left, Pos(_), QuadrantInside) => "┼",
        (Through, Left, Pos(_), QuadrantOutside) => "┼",
        (Through, Left, End, Plain) => "└",
        (Through, Left, End, Rounded) => "└",
        (Through, Left, End, Double) => "└",
        (Through, Left, End, Thick) => "└",
        (Through, Left, End, QuadrantInside) => "└",
        (Through, Left, End, QuadrantOutside) => "└",
        (Through, Left, ProlongEnd, Plain) => "└",
        (Through, Left, ProlongEnd, Rounded) => "└",
        (Through, Left, ProlongEnd, Double) => "└",
        (Through, Left, ProlongEnd, Thick) => "└",
        (Through, Left, ProlongEnd, QuadrantInside) => "└",
        (Through, Left, ProlongEnd, QuadrantOutside) => "└",

        (Manual(cc), _, _, _) => cc,
    }
}

fn double_joint(joint: Joint) -> &'static str {
    use BorderType::*;
    use JointPos::*;
    use JointScale::*;
    use JointSide::*;

    match (joint.scale, joint.side, joint.pos, joint.border) {
        (Out, Top, ProlongStart, Plain) => "╦",
        (Out, Top, ProlongStart, Rounded) => "╦",
        (Out, Top, ProlongStart, Double) => "╦",
        (Out, Top, ProlongStart, Thick) => "╦",
        (Out, Top, ProlongStart, QuadrantInside) => "╦",
        (Out, Top, ProlongStart, QuadrantOutside) => "╦",
        (Out, Top, Start, Plain) => "╠",
        (Out, Top, Start, Rounded) => "╠",
        (Out, Top, Start, Double) => "╠",
        (Out, Top, Start, Thick) => "╠",
        (Out, Top, Start, QuadrantInside) => "╠",
        (Out, Top, Start, QuadrantOutside) => "╠",
        (Out, Top, Pos(_), Plain) => "╧",
        (Out, Top, Pos(_), Rounded) => "╧",
        (Out, Top, Pos(_), Double) => "╩",
        (Out, Top, Pos(_), Thick) => "╩",
        (Out, Top, Pos(_), QuadrantInside) => "╩",
        (Out, Top, Pos(_), QuadrantOutside) => "╩",
        (Out, Top, End, Plain) => "╣",
        (Out, Top, End, Rounded) => "╣",
        (Out, Top, End, Double) => "╣",
        (Out, Top, End, Thick) => "╣",
        (Out, Top, End, QuadrantInside) => "╣",
        (Out, Top, End, QuadrantOutside) => "╣",
        (Out, Top, ProlongEnd, Plain) => "╦",
        (Out, Top, ProlongEnd, Rounded) => "╦",
        (Out, Top, ProlongEnd, Double) => "╦",
        (Out, Top, ProlongEnd, Thick) => "╦",
        (Out, Top, ProlongEnd, QuadrantInside) => "╦",
        (Out, Top, ProlongEnd, QuadrantOutside) => "╦",

        (Out, Right, ProlongStart, Plain) => "╣",
        (Out, Right, ProlongStart, Rounded) => "╣",
        (Out, Right, ProlongStart, Double) => "╣",
        (Out, Right, ProlongStart, Thick) => "╣",
        (Out, Right, ProlongStart, QuadrantInside) => "╣",
        (Out, Right, ProlongStart, QuadrantOutside) => "╣",
        (Out, Right, Start, Plain) => "╦",
        (Out, Right, Start, Rounded) => "╦",
        (Out, Right, Start, Double) => "╦",
        (Out, Right, Start, Thick) => "╦",
        (Out, Right, Start, QuadrantInside) => "╦",
        (Out, Right, Start, QuadrantOutside) => "╦",
        (Out, Right, Pos(_), Plain) => "╟",
        (Out, Right, Pos(_), Rounded) => "╟",
        (Out, Right, Pos(_), Double) => "╠",
        (Out, Right, Pos(_), Thick) => "╠",
        (Out, Right, Pos(_), QuadrantInside) => "╟",
        (Out, Right, Pos(_), QuadrantOutside) => "╟",
        (Out, Right, End, Plain) => "╩",
        (Out, Right, End, Rounded) => "╩",
        (Out, Right, End, Double) => "╩",
        (Out, Right, End, Thick) => "╩",
        (Out, Right, End, QuadrantInside) => "╩",
        (Out, Right, End, QuadrantOutside) => "╩",
        (Out, Right, ProlongEnd, Plain) => "╣",
        (Out, Right, ProlongEnd, Rounded) => "╣",
        (Out, Right, ProlongEnd, Double) => "╣",
        (Out, Right, ProlongEnd, Thick) => "╣",
        (Out, Right, ProlongEnd, QuadrantInside) => "╣",
        (Out, Right, ProlongEnd, QuadrantOutside) => "╣",

        (Out, Bottom, ProlongStart, Plain) => "╩",
        (Out, Bottom, ProlongStart, Rounded) => "╩",
        (Out, Bottom, ProlongStart, Double) => "╩",
        (Out, Bottom, ProlongStart, Thick) => "╩",
        (Out, Bottom, ProlongStart, QuadrantInside) => "╩",
        (Out, Bottom, ProlongStart, QuadrantOutside) => "╩",
        (Out, Bottom, Start, Plain) => "╠",
        (Out, Bottom, Start, Rounded) => "╠",
        (Out, Bottom, Start, Double) => "╠",
        (Out, Bottom, Start, Thick) => "╠",
        (Out, Bottom, Start, QuadrantInside) => "╠",
        (Out, Bottom, Start, QuadrantOutside) => "╠",
        (Out, Bottom, Pos(_), Plain) => "╤",
        (Out, Bottom, Pos(_), Rounded) => "╤",
        (Out, Bottom, Pos(_), Double) => "╦",
        (Out, Bottom, Pos(_), Thick) => "╦",
        (Out, Bottom, Pos(_), QuadrantInside) => "╦",
        (Out, Bottom, Pos(_), QuadrantOutside) => "╦",
        (Out, Bottom, End, Plain) => "╣",
        (Out, Bottom, End, Rounded) => "╣",
        (Out, Bottom, End, Double) => "╣",
        (Out, Bottom, End, Thick) => "╣",
        (Out, Bottom, End, QuadrantInside) => "╣",
        (Out, Bottom, End, QuadrantOutside) => "╣",
        (Out, Bottom, ProlongEnd, Plain) => "╩",
        (Out, Bottom, ProlongEnd, Rounded) => "╩",
        (Out, Bottom, ProlongEnd, Double) => "╩",
        (Out, Bottom, ProlongEnd, Thick) => "╩",
        (Out, Bottom, ProlongEnd, QuadrantInside) => "╩",
        (Out, Bottom, ProlongEnd, QuadrantOutside) => "╩",

        (Out, Left, ProlongStart, Plain) => "╠",
        (Out, Left, ProlongStart, Rounded) => "╠",
        (Out, Left, ProlongStart, Double) => "╠",
        (Out, Left, ProlongStart, Thick) => "╠",
        (Out, Left, ProlongStart, QuadrantInside) => "╠",
        (Out, Left, ProlongStart, QuadrantOutside) => "╠",
        (Out, Left, Start, Plain) => "╦",
        (Out, Left, Start, Rounded) => "╦",
        (Out, Left, Start, Double) => "╦",
        (Out, Left, Start, Thick) => "╦",
        (Out, Left, Start, QuadrantInside) => "╦",
        (Out, Left, Start, QuadrantOutside) => "╦",
        (Out, Left, Pos(_), Plain) => "╢",
        (Out, Left, Pos(_), Rounded) => "╢",
        (Out, Left, Pos(_), Double) => "╣",
        (Out, Left, Pos(_), Thick) => "╣",
        (Out, Left, Pos(_), QuadrantInside) => "╣",
        (Out, Left, Pos(_), QuadrantOutside) => "╣",
        (Out, Left, End, Plain) => "╩",
        (Out, Left, End, Rounded) => "╩",
        (Out, Left, End, Double) => "╩",
        (Out, Left, End, Thick) => "╩",
        (Out, Left, End, QuadrantInside) => "╩",
        (Out, Left, End, QuadrantOutside) => "╩",
        (Out, Left, ProlongEnd, Plain) => "╠",
        (Out, Left, ProlongEnd, Rounded) => "╠",
        (Out, Left, ProlongEnd, Double) => "╠",
        (Out, Left, ProlongEnd, Thick) => "╠",
        (Out, Left, ProlongEnd, QuadrantInside) => "╠",
        (Out, Left, ProlongEnd, QuadrantOutside) => "╠",

        // ----------------------------------------------
        (In, Top, ProlongStart, Plain) => "╔",
        (In, Top, ProlongStart, Rounded) => "╔",
        (In, Top, ProlongStart, Double) => "╔",
        (In, Top, ProlongStart, Thick) => "╔",
        (In, Top, ProlongStart, QuadrantInside) => "╔",
        (In, Top, ProlongStart, QuadrantOutside) => "╔",
        (In, Top, Start, Plain) => "╔",
        (In, Top, Start, Rounded) => "╔",
        (In, Top, Start, Double) => "╔",
        (In, Top, Start, Thick) => "╔",
        (In, Top, Start, QuadrantInside) => "╔",
        (In, Top, Start, QuadrantOutside) => "╔",
        (In, Top, Pos(_), Plain) => "╤",
        (In, Top, Pos(_), Rounded) => "╤",
        (In, Top, Pos(_), Double) => "╦",
        (In, Top, Pos(_), Thick) => "╦",
        (In, Top, Pos(_), QuadrantInside) => "╦",
        (In, Top, Pos(_), QuadrantOutside) => "╦",
        (In, Top, End, Plain) => "╗",
        (In, Top, End, Rounded) => "╗",
        (In, Top, End, Double) => "╗",
        (In, Top, End, Thick) => "╗",
        (In, Top, End, QuadrantInside) => "╗",
        (In, Top, End, QuadrantOutside) => "╗",
        (In, Top, ProlongEnd, Plain) => "╗",
        (In, Top, ProlongEnd, Rounded) => "╗",
        (In, Top, ProlongEnd, Double) => "╗",
        (In, Top, ProlongEnd, Thick) => "╗",
        (In, Top, ProlongEnd, QuadrantInside) => "╗",
        (In, Top, ProlongEnd, QuadrantOutside) => "╗",

        (In, Right, ProlongStart, Plain) => "╗",
        (In, Right, ProlongStart, Rounded) => "╗",
        (In, Right, ProlongStart, Double) => "╗",
        (In, Right, ProlongStart, Thick) => "╗",
        (In, Right, ProlongStart, QuadrantInside) => "╗",
        (In, Right, ProlongStart, QuadrantOutside) => "╗",
        (In, Right, Start, Plain) => "╗",
        (In, Right, Start, Rounded) => "╗",
        (In, Right, Start, Double) => "╗",
        (In, Right, Start, Thick) => "╗",
        (In, Right, Start, QuadrantInside) => "╗",
        (In, Right, Start, QuadrantOutside) => "╗",
        (In, Right, Pos(_), Plain) => "╢",
        (In, Right, Pos(_), Rounded) => "╢",
        (In, Right, Pos(_), Double) => "╣",
        (In, Right, Pos(_), Thick) => "╣",
        (In, Right, Pos(_), QuadrantInside) => "╣",
        (In, Right, Pos(_), QuadrantOutside) => "╣",
        (In, Right, End, Plain) => "╝",
        (In, Right, End, Rounded) => "╝",
        (In, Right, End, Double) => "╝",
        (In, Right, End, Thick) => "╝",
        (In, Right, End, QuadrantInside) => "╝",
        (In, Right, End, QuadrantOutside) => "╝",
        (In, Right, ProlongEnd, Plain) => "╝",
        (In, Right, ProlongEnd, Rounded) => "╝",
        (In, Right, ProlongEnd, Double) => "╝",
        (In, Right, ProlongEnd, Thick) => "╝",
        (In, Right, ProlongEnd, QuadrantInside) => "╝",
        (In, Right, ProlongEnd, QuadrantOutside) => "╝",

        (In, Bottom, ProlongStart, Plain) => "╚",
        (In, Bottom, ProlongStart, Rounded) => "╚",
        (In, Bottom, ProlongStart, Double) => "╚",
        (In, Bottom, ProlongStart, Thick) => "╚",
        (In, Bottom, ProlongStart, QuadrantInside) => "╚",
        (In, Bottom, ProlongStart, QuadrantOutside) => "╚",
        (In, Bottom, Start, Plain) => "╚",
        (In, Bottom, Start, Rounded) => "╚",
        (In, Bottom, Start, Double) => "╚",
        (In, Bottom, Start, Thick) => "╚",
        (In, Bottom, Start, QuadrantInside) => "╚",
        (In, Bottom, Start, QuadrantOutside) => "╚",
        (In, Bottom, Pos(_), Plain) => "╧",
        (In, Bottom, Pos(_), Rounded) => "╧",
        (In, Bottom, Pos(_), Double) => "╩",
        (In, Bottom, Pos(_), Thick) => "╩",
        (In, Bottom, Pos(_), QuadrantInside) => "╩",
        (In, Bottom, Pos(_), QuadrantOutside) => "╩",
        (In, Bottom, End, Plain) => "╝",
        (In, Bottom, End, Rounded) => "╝",
        (In, Bottom, End, Double) => "╝",
        (In, Bottom, End, Thick) => "╝",
        (In, Bottom, End, QuadrantInside) => "╝",
        (In, Bottom, End, QuadrantOutside) => "╝",
        (In, Bottom, ProlongEnd, Plain) => "╝",
        (In, Bottom, ProlongEnd, Rounded) => "╝",
        (In, Bottom, ProlongEnd, Double) => "╝",
        (In, Bottom, ProlongEnd, Thick) => "╝",
        (In, Bottom, ProlongEnd, QuadrantInside) => "╝",
        (In, Bottom, ProlongEnd, QuadrantOutside) => "╝",

        (In, Left, ProlongStart, Plain) => "╔",
        (In, Left, ProlongStart, Rounded) => "╔",
        (In, Left, ProlongStart, Double) => "╔",
        (In, Left, ProlongStart, Thick) => "╔",
        (In, Left, ProlongStart, QuadrantInside) => "╔",
        (In, Left, ProlongStart, QuadrantOutside) => "╔",
        (In, Left, Start, Plain) => "╔",
        (In, Left, Start, Rounded) => "╔",
        (In, Left, Start, Double) => "╔",
        (In, Left, Start, Thick) => "╔",
        (In, Left, Start, QuadrantInside) => "╔",
        (In, Left, Start, QuadrantOutside) => "╔",
        (In, Left, Pos(_), Plain) => "╟",
        (In, Left, Pos(_), Rounded) => "╟",
        (In, Left, Pos(_), Double) => "╠",
        (In, Left, Pos(_), Thick) => "╠",
        (In, Left, Pos(_), QuadrantInside) => "╠",
        (In, Left, Pos(_), QuadrantOutside) => "╠",
        (In, Left, End, Plain) => "╚",
        (In, Left, End, Rounded) => "╚",
        (In, Left, End, Double) => "╚",
        (In, Left, End, Thick) => "╚",
        (In, Left, End, QuadrantInside) => "╚",
        (In, Left, End, QuadrantOutside) => "╚",
        (In, Left, ProlongEnd, Plain) => "╚",
        (In, Left, ProlongEnd, Rounded) => "╚",
        (In, Left, ProlongEnd, Double) => "╚",
        (In, Left, ProlongEnd, Thick) => "╚",
        (In, Left, ProlongEnd, QuadrantInside) => "╚",
        (In, Left, ProlongEnd, QuadrantOutside) => "╚",

        // ----------------------------------------------
        (Through, Top, ProlongStart, Plain) => "╔",
        (Through, Top, ProlongStart, Rounded) => "╔",
        (Through, Top, ProlongStart, Double) => "╔",
        (Through, Top, ProlongStart, Thick) => "╔",
        (Through, Top, ProlongStart, QuadrantInside) => "╔",
        (Through, Top, ProlongStart, QuadrantOutside) => "╔",
        (Through, Top, Start, Plain) => "╔",
        (Through, Top, Start, Rounded) => "╔",
        (Through, Top, Start, Double) => "╔",
        (Through, Top, Start, Thick) => "╔",
        (Through, Top, Start, QuadrantInside) => "╔",
        (Through, Top, Start, QuadrantOutside) => "╔",
        (Through, Top, Pos(_), Plain) => "╪",
        (Through, Top, Pos(_), Rounded) => "╪",
        (Through, Top, Pos(_), Double) => "╬",
        (Through, Top, Pos(_), Thick) => "╬",
        (Through, Top, Pos(_), QuadrantInside) => "╬",
        (Through, Top, Pos(_), QuadrantOutside) => "╬",
        (Through, Top, End, Plain) => "╗",
        (Through, Top, End, Rounded) => "╗",
        (Through, Top, End, Double) => "╗",
        (Through, Top, End, Thick) => "╗",
        (Through, Top, End, QuadrantInside) => "╗",
        (Through, Top, End, QuadrantOutside) => "╗",
        (Through, Top, ProlongEnd, Plain) => "╗",
        (Through, Top, ProlongEnd, Rounded) => "╗",
        (Through, Top, ProlongEnd, Double) => "╗",
        (Through, Top, ProlongEnd, Thick) => "╗",
        (Through, Top, ProlongEnd, QuadrantInside) => "╗",
        (Through, Top, ProlongEnd, QuadrantOutside) => "╗",

        (Through, Right, ProlongStart, Plain) => "╗",
        (Through, Right, ProlongStart, Rounded) => "╗",
        (Through, Right, ProlongStart, Double) => "╗",
        (Through, Right, ProlongStart, Thick) => "╗",
        (Through, Right, ProlongStart, QuadrantInside) => "╗",
        (Through, Right, ProlongStart, QuadrantOutside) => "╗",
        (Through, Right, Start, Plain) => "╗",
        (Through, Right, Start, Rounded) => "╗",
        (Through, Right, Start, Double) => "╗",
        (Through, Right, Start, Thick) => "╗",
        (Through, Right, Start, QuadrantInside) => "╗",
        (Through, Right, Start, QuadrantOutside) => "╗",
        (Through, Right, Pos(_), Plain) => "╫",
        (Through, Right, Pos(_), Rounded) => "╫",
        (Through, Right, Pos(_), Double) => "╬",
        (Through, Right, Pos(_), Thick) => "╬",
        (Through, Right, Pos(_), QuadrantInside) => "╬",
        (Through, Right, Pos(_), QuadrantOutside) => "╬",
        (Through, Right, End, Plain) => "╝",
        (Through, Right, End, Rounded) => "╝",
        (Through, Right, End, Double) => "╝",
        (Through, Right, End, Thick) => "╝",
        (Through, Right, End, QuadrantInside) => "╝",
        (Through, Right, End, QuadrantOutside) => "╝",
        (Through, Right, ProlongEnd, Plain) => "╝",
        (Through, Right, ProlongEnd, Rounded) => "╝",
        (Through, Right, ProlongEnd, Double) => "╝",
        (Through, Right, ProlongEnd, Thick) => "╝",
        (Through, Right, ProlongEnd, QuadrantInside) => "╝",
        (Through, Right, ProlongEnd, QuadrantOutside) => "╝",

        (Through, Bottom, ProlongStart, Plain) => "╚",
        (Through, Bottom, ProlongStart, Rounded) => "╚",
        (Through, Bottom, ProlongStart, Double) => "╚",
        (Through, Bottom, ProlongStart, Thick) => "╚",
        (Through, Bottom, ProlongStart, QuadrantInside) => "╚",
        (Through, Bottom, ProlongStart, QuadrantOutside) => "╚",
        (Through, Bottom, Start, Plain) => "╚",
        (Through, Bottom, Start, Rounded) => "╚",
        (Through, Bottom, Start, Double) => "╚",
        (Through, Bottom, Start, Thick) => "╚",
        (Through, Bottom, Start, QuadrantInside) => "╚",
        (Through, Bottom, Start, QuadrantOutside) => "╚",
        (Through, Bottom, Pos(_), Plain) => "╪",
        (Through, Bottom, Pos(_), Rounded) => "╪",
        (Through, Bottom, Pos(_), Double) => "╬",
        (Through, Bottom, Pos(_), Thick) => "╬",
        (Through, Bottom, Pos(_), QuadrantInside) => "╬",
        (Through, Bottom, Pos(_), QuadrantOutside) => "╬",
        (Through, Bottom, End, Plain) => "╝",
        (Through, Bottom, End, Rounded) => "╝",
        (Through, Bottom, End, Double) => "╝",
        (Through, Bottom, End, Thick) => "╝",
        (Through, Bottom, End, QuadrantInside) => "╝",
        (Through, Bottom, End, QuadrantOutside) => "╝",
        (Through, Bottom, ProlongEnd, Plain) => "╝",
        (Through, Bottom, ProlongEnd, Rounded) => "╝",
        (Through, Bottom, ProlongEnd, Double) => "╝",
        (Through, Bottom, ProlongEnd, Thick) => "╝",
        (Through, Bottom, ProlongEnd, QuadrantInside) => "╝",
        (Through, Bottom, ProlongEnd, QuadrantOutside) => "╝",

        (Through, Left, ProlongStart, Plain) => "╔",
        (Through, Left, ProlongStart, Rounded) => "╔",
        (Through, Left, ProlongStart, Double) => "╔",
        (Through, Left, ProlongStart, Thick) => "╔",
        (Through, Left, ProlongStart, QuadrantInside) => "╔",
        (Through, Left, ProlongStart, QuadrantOutside) => "╔",
        (Through, Left, Start, Plain) => "╔",
        (Through, Left, Start, Rounded) => "╔",
        (Through, Left, Start, Double) => "╔",
        (Through, Left, Start, Thick) => "╔",
        (Through, Left, Start, QuadrantInside) => "╔",
        (Through, Left, Start, QuadrantOutside) => "╔",
        (Through, Left, Pos(_), Plain) => "╫",
        (Through, Left, Pos(_), Rounded) => "╫",
        (Through, Left, Pos(_), Double) => "╬",
        (Through, Left, Pos(_), Thick) => "╬",
        (Through, Left, Pos(_), QuadrantInside) => "╬",
        (Through, Left, Pos(_), QuadrantOutside) => "╬",
        (Through, Left, End, Plain) => "╚",
        (Through, Left, End, Rounded) => "╚",
        (Through, Left, End, Double) => "╚",
        (Through, Left, End, Thick) => "╚",
        (Through, Left, End, QuadrantInside) => "╚",
        (Through, Left, End, QuadrantOutside) => "╚",
        (Through, Left, ProlongEnd, Plain) => "╚",
        (Through, Left, ProlongEnd, Rounded) => "╚",
        (Through, Left, ProlongEnd, Double) => "╚",
        (Through, Left, ProlongEnd, Thick) => "╚",
        (Through, Left, ProlongEnd, QuadrantInside) => "╚",
        (Through, Left, ProlongEnd, QuadrantOutside) => "╚",

        (Manual(cc), _, _, _) => cc,
    }
}

fn thick_joint(joint: Joint) -> &'static str {
    use BorderType::*;
    use JointPos::*;
    use JointScale::*;
    use JointSide::*;

    match (joint.scale, joint.side, joint.pos, joint.border) {
        (Out, Top, ProlongStart, Plain) => "┲",
        (Out, Top, ProlongStart, Rounded) => "┲",
        (Out, Top, ProlongStart, Double) => "┳",
        (Out, Top, ProlongStart, Thick) => "┳",
        (Out, Top, ProlongStart, QuadrantInside) => "┳",
        (Out, Top, ProlongStart, QuadrantOutside) => "┳",
        (Out, Top, Start, Plain) => "┢",
        (Out, Top, Start, Rounded) => "┢",
        (Out, Top, Start, Double) => "┣",
        (Out, Top, Start, Thick) => "┣",
        (Out, Top, Start, QuadrantInside) => "┣",
        (Out, Top, Start, QuadrantOutside) => "┣",
        (Out, Top, Pos(_), Plain) => "┷",
        (Out, Top, Pos(_), Rounded) => "┷",
        (Out, Top, Pos(_), Double) => "┻",
        (Out, Top, Pos(_), Thick) => "┻",
        (Out, Top, Pos(_), QuadrantInside) => "┻",
        (Out, Top, Pos(_), QuadrantOutside) => "┻",
        (Out, Top, End, Plain) => "┪",
        (Out, Top, End, Rounded) => "┪",
        (Out, Top, End, Double) => "┫",
        (Out, Top, End, Thick) => "┫",
        (Out, Top, End, QuadrantInside) => "┫",
        (Out, Top, End, QuadrantOutside) => "┫",
        (Out, Top, ProlongEnd, Plain) => "┱",
        (Out, Top, ProlongEnd, Rounded) => "┱",
        (Out, Top, ProlongEnd, Double) => "┳",
        (Out, Top, ProlongEnd, Thick) => "┳",
        (Out, Top, ProlongEnd, QuadrantInside) => "┳",
        (Out, Top, ProlongEnd, QuadrantOutside) => "┳",

        (Out, Right, ProlongStart, Plain) => "┪",
        (Out, Right, ProlongStart, Rounded) => "┪",
        (Out, Right, ProlongStart, Double) => "┫",
        (Out, Right, ProlongStart, Thick) => "┫",
        (Out, Right, ProlongStart, QuadrantInside) => "┫",
        (Out, Right, ProlongStart, QuadrantOutside) => "┫",
        (Out, Right, Start, Plain) => "┱",
        (Out, Right, Start, Rounded) => "┱",
        (Out, Right, Start, Double) => "┳",
        (Out, Right, Start, Thick) => "┳",
        (Out, Right, Start, QuadrantInside) => "┳",
        (Out, Right, Start, QuadrantOutside) => "┳",
        (Out, Right, Pos(_), Plain) => "┠",
        (Out, Right, Pos(_), Rounded) => "┠",
        (Out, Right, Pos(_), Double) => "┣",
        (Out, Right, Pos(_), Thick) => "┣",
        (Out, Right, Pos(_), QuadrantInside) => "┣",
        (Out, Right, Pos(_), QuadrantOutside) => "┣",
        (Out, Right, End, Plain) => "┹",
        (Out, Right, End, Rounded) => "┹",
        (Out, Right, End, Double) => "┻",
        (Out, Right, End, Thick) => "┻",
        (Out, Right, End, QuadrantInside) => "┻",
        (Out, Right, End, QuadrantOutside) => "┻",
        (Out, Right, ProlongEnd, Plain) => "┩",
        (Out, Right, ProlongEnd, Rounded) => "┩",
        (Out, Right, ProlongEnd, Double) => "┫",
        (Out, Right, ProlongEnd, Thick) => "┫",
        (Out, Right, ProlongEnd, QuadrantInside) => "┫",
        (Out, Right, ProlongEnd, QuadrantOutside) => "┫",

        (Out, Bottom, ProlongStart, Plain) => "┺",
        (Out, Bottom, ProlongStart, Rounded) => "┺",
        (Out, Bottom, ProlongStart, Double) => "┻",
        (Out, Bottom, ProlongStart, Thick) => "┻",
        (Out, Bottom, ProlongStart, QuadrantInside) => "┻",
        (Out, Bottom, ProlongStart, QuadrantOutside) => "┻",
        (Out, Bottom, Start, Plain) => "┡",
        (Out, Bottom, Start, Rounded) => "┡",
        (Out, Bottom, Start, Double) => "┣",
        (Out, Bottom, Start, Thick) => "┣",
        (Out, Bottom, Start, QuadrantInside) => "┣",
        (Out, Bottom, Start, QuadrantOutside) => "┣",
        (Out, Bottom, Pos(_), Plain) => "┯",
        (Out, Bottom, Pos(_), Rounded) => "┯",
        (Out, Bottom, Pos(_), Double) => "┳",
        (Out, Bottom, Pos(_), Thick) => "┳",
        (Out, Bottom, Pos(_), QuadrantInside) => "┳",
        (Out, Bottom, Pos(_), QuadrantOutside) => "┳",
        (Out, Bottom, End, Plain) => "┩",
        (Out, Bottom, End, Rounded) => "┩",
        (Out, Bottom, End, Double) => "┫",
        (Out, Bottom, End, Thick) => "┫",
        (Out, Bottom, End, QuadrantInside) => "┫",
        (Out, Bottom, End, QuadrantOutside) => "┫",
        (Out, Bottom, ProlongEnd, Plain) => "┹",
        (Out, Bottom, ProlongEnd, Rounded) => "┹",
        (Out, Bottom, ProlongEnd, Double) => "┻",
        (Out, Bottom, ProlongEnd, Thick) => "┻",
        (Out, Bottom, ProlongEnd, QuadrantInside) => "┻",
        (Out, Bottom, ProlongEnd, QuadrantOutside) => "┻",

        (Out, Left, ProlongStart, Plain) => "┢",
        (Out, Left, ProlongStart, Rounded) => "┢",
        (Out, Left, ProlongStart, Double) => "┣",
        (Out, Left, ProlongStart, Thick) => "┣",
        (Out, Left, ProlongStart, QuadrantInside) => "┣",
        (Out, Left, ProlongStart, QuadrantOutside) => "┣",
        (Out, Left, Start, Plain) => "┲",
        (Out, Left, Start, Rounded) => "┲",
        (Out, Left, Start, Double) => "┳",
        (Out, Left, Start, Thick) => "┳",
        (Out, Left, Start, QuadrantInside) => "┳",
        (Out, Left, Start, QuadrantOutside) => "┳",
        (Out, Left, Pos(_), Plain) => "┨",
        (Out, Left, Pos(_), Rounded) => "┨",
        (Out, Left, Pos(_), Double) => "┫",
        (Out, Left, Pos(_), Thick) => "┫",
        (Out, Left, Pos(_), QuadrantInside) => "┫",
        (Out, Left, Pos(_), QuadrantOutside) => "┫",
        (Out, Left, End, Plain) => "┺",
        (Out, Left, End, Rounded) => "┺",
        (Out, Left, End, Double) => "┻",
        (Out, Left, End, Thick) => "┻",
        (Out, Left, End, QuadrantInside) => "┻",
        (Out, Left, End, QuadrantOutside) => "┻",
        (Out, Left, ProlongEnd, Plain) => "┡",
        (Out, Left, ProlongEnd, Rounded) => "┡",
        (Out, Left, ProlongEnd, Double) => "┣",
        (Out, Left, ProlongEnd, Thick) => "┣",
        (Out, Left, ProlongEnd, QuadrantInside) => "┣",
        (Out, Left, ProlongEnd, QuadrantOutside) => "┣",

        // ----------------------------------------------
        (In, Top, ProlongStart, Plain) => "┏",
        (In, Top, ProlongStart, Rounded) => "┏",
        (In, Top, ProlongStart, Double) => "┏",
        (In, Top, ProlongStart, Thick) => "┏",
        (In, Top, ProlongStart, QuadrantInside) => "┏",
        (In, Top, ProlongStart, QuadrantOutside) => "┏",
        (In, Top, Start, Plain) => "┏",
        (In, Top, Start, Rounded) => "┏",
        (In, Top, Start, Double) => "┏",
        (In, Top, Start, Thick) => "┏",
        (In, Top, Start, QuadrantInside) => "┏",
        (In, Top, Start, QuadrantOutside) => "┏",
        (In, Top, Pos(_), Plain) => "┯",
        (In, Top, Pos(_), Rounded) => "┯",
        (In, Top, Pos(_), Double) => "┳",
        (In, Top, Pos(_), Thick) => "┳",
        (In, Top, Pos(_), QuadrantInside) => "┳",
        (In, Top, Pos(_), QuadrantOutside) => "┳",
        (In, Top, End, Plain) => "┓",
        (In, Top, End, Rounded) => "┓",
        (In, Top, End, Double) => "┓",
        (In, Top, End, Thick) => "┓",
        (In, Top, End, QuadrantInside) => "┓",
        (In, Top, End, QuadrantOutside) => "┓",
        (In, Top, ProlongEnd, Plain) => "┓",
        (In, Top, ProlongEnd, Rounded) => "┓",
        (In, Top, ProlongEnd, Double) => "┓",
        (In, Top, ProlongEnd, Thick) => "┓",
        (In, Top, ProlongEnd, QuadrantInside) => "┓",
        (In, Top, ProlongEnd, QuadrantOutside) => "┓",

        (In, Right, ProlongStart, Plain) => "┓",
        (In, Right, ProlongStart, Rounded) => "┓",
        (In, Right, ProlongStart, Double) => "┓",
        (In, Right, ProlongStart, Thick) => "┓",
        (In, Right, ProlongStart, QuadrantInside) => "┓",
        (In, Right, ProlongStart, QuadrantOutside) => "┓",
        (In, Right, Start, Plain) => "┓",
        (In, Right, Start, Rounded) => "┓",
        (In, Right, Start, Double) => "┓",
        (In, Right, Start, Thick) => "┓",
        (In, Right, Start, QuadrantInside) => "┓",
        (In, Right, Start, QuadrantOutside) => "┓",
        (In, Right, Pos(_), Plain) => "┨",
        (In, Right, Pos(_), Rounded) => "┨",
        (In, Right, Pos(_), Double) => "┫",
        (In, Right, Pos(_), Thick) => "┫",
        (In, Right, Pos(_), QuadrantInside) => "┫",
        (In, Right, Pos(_), QuadrantOutside) => "┫",
        (In, Right, End, Plain) => "┛",
        (In, Right, End, Rounded) => "┛",
        (In, Right, End, Double) => "┛",
        (In, Right, End, Thick) => "┛",
        (In, Right, End, QuadrantInside) => "┛",
        (In, Right, End, QuadrantOutside) => "┛",
        (In, Right, ProlongEnd, Plain) => "┛",
        (In, Right, ProlongEnd, Rounded) => "┛",
        (In, Right, ProlongEnd, Double) => "┛",
        (In, Right, ProlongEnd, Thick) => "┛",
        (In, Right, ProlongEnd, QuadrantInside) => "┛",
        (In, Right, ProlongEnd, QuadrantOutside) => "┛",

        (In, Bottom, ProlongStart, Plain) => "┗",
        (In, Bottom, ProlongStart, Rounded) => "┗",
        (In, Bottom, ProlongStart, Double) => "┗",
        (In, Bottom, ProlongStart, Thick) => "┗",
        (In, Bottom, ProlongStart, QuadrantInside) => "┗",
        (In, Bottom, ProlongStart, QuadrantOutside) => "┗",
        (In, Bottom, Start, Plain) => "┗",
        (In, Bottom, Start, Rounded) => "┗",
        (In, Bottom, Start, Double) => "┗",
        (In, Bottom, Start, Thick) => "┗",
        (In, Bottom, Start, QuadrantInside) => "┗",
        (In, Bottom, Start, QuadrantOutside) => "┗",
        (In, Bottom, Pos(_), Plain) => "┷",
        (In, Bottom, Pos(_), Rounded) => "┷",
        (In, Bottom, Pos(_), Double) => "┻",
        (In, Bottom, Pos(_), Thick) => "┻",
        (In, Bottom, Pos(_), QuadrantInside) => "┻",
        (In, Bottom, Pos(_), QuadrantOutside) => "┻",
        (In, Bottom, End, Plain) => "┛",
        (In, Bottom, End, Rounded) => "┛",
        (In, Bottom, End, Double) => "┛",
        (In, Bottom, End, Thick) => "┛",
        (In, Bottom, End, QuadrantInside) => "┛",
        (In, Bottom, End, QuadrantOutside) => "┛",
        (In, Bottom, ProlongEnd, Plain) => "┛",
        (In, Bottom, ProlongEnd, Rounded) => "┛",
        (In, Bottom, ProlongEnd, Double) => "┛",
        (In, Bottom, ProlongEnd, Thick) => "┛",
        (In, Bottom, ProlongEnd, QuadrantInside) => "┛",
        (In, Bottom, ProlongEnd, QuadrantOutside) => "┛",

        (In, Left, ProlongStart, Plain) => "┏",
        (In, Left, ProlongStart, Rounded) => "┏",
        (In, Left, ProlongStart, Double) => "┏",
        (In, Left, ProlongStart, Thick) => "┏",
        (In, Left, ProlongStart, QuadrantInside) => "┏",
        (In, Left, ProlongStart, QuadrantOutside) => "┏",
        (In, Left, Start, Plain) => "┏",
        (In, Left, Start, Rounded) => "┏",
        (In, Left, Start, Double) => "┏",
        (In, Left, Start, Thick) => "┏",
        (In, Left, Start, QuadrantInside) => "┏",
        (In, Left, Start, QuadrantOutside) => "┏",
        (In, Left, Pos(_), Plain) => "┠",
        (In, Left, Pos(_), Rounded) => "┠",
        (In, Left, Pos(_), Double) => "┣",
        (In, Left, Pos(_), Thick) => "┣",
        (In, Left, Pos(_), QuadrantInside) => "┣",
        (In, Left, Pos(_), QuadrantOutside) => "┣",
        (In, Left, End, Plain) => "┗",
        (In, Left, End, Rounded) => "┗",
        (In, Left, End, Double) => "┗",
        (In, Left, End, Thick) => "┗",
        (In, Left, End, QuadrantInside) => "┗",
        (In, Left, End, QuadrantOutside) => "┗",
        (In, Left, ProlongEnd, Plain) => "┗",
        (In, Left, ProlongEnd, Rounded) => "┗",
        (In, Left, ProlongEnd, Double) => "┗",
        (In, Left, ProlongEnd, Thick) => "┗",
        (In, Left, ProlongEnd, QuadrantInside) => "┗",
        (In, Left, ProlongEnd, QuadrantOutside) => "┗",

        // ----------------------------------------------
        (Through, Top, ProlongStart, Plain) => "┏",
        (Through, Top, ProlongStart, Rounded) => "┏",
        (Through, Top, ProlongStart, Double) => "┏",
        (Through, Top, ProlongStart, Thick) => "┏",
        (Through, Top, ProlongStart, QuadrantInside) => "┏",
        (Through, Top, ProlongStart, QuadrantOutside) => "┏",
        (Through, Top, Start, Plain) => "┏",
        (Through, Top, Start, Rounded) => "┏",
        (Through, Top, Start, Double) => "┏",
        (Through, Top, Start, Thick) => "┏",
        (Through, Top, Start, QuadrantInside) => "┏",
        (Through, Top, Start, QuadrantOutside) => "┏",
        (Through, Top, Pos(_), Plain) => "┿",
        (Through, Top, Pos(_), Rounded) => "┿",
        (Through, Top, Pos(_), Double) => "╋",
        (Through, Top, Pos(_), Thick) => "╋",
        (Through, Top, Pos(_), QuadrantInside) => "╋",
        (Through, Top, Pos(_), QuadrantOutside) => "╋",
        (Through, Top, End, Plain) => "┓",
        (Through, Top, End, Rounded) => "┓",
        (Through, Top, End, Double) => "┓",
        (Through, Top, End, Thick) => "┓",
        (Through, Top, End, QuadrantInside) => "┓",
        (Through, Top, End, QuadrantOutside) => "┓",
        (Through, Top, ProlongEnd, Plain) => "┓",
        (Through, Top, ProlongEnd, Rounded) => "┓",
        (Through, Top, ProlongEnd, Double) => "┓",
        (Through, Top, ProlongEnd, Thick) => "┓",
        (Through, Top, ProlongEnd, QuadrantInside) => "┓",
        (Through, Top, ProlongEnd, QuadrantOutside) => "┓",

        (Through, Right, ProlongStart, Plain) => "┓",
        (Through, Right, ProlongStart, Rounded) => "┓",
        (Through, Right, ProlongStart, Double) => "┓",
        (Through, Right, ProlongStart, Thick) => "┓",
        (Through, Right, ProlongStart, QuadrantInside) => "┓",
        (Through, Right, ProlongStart, QuadrantOutside) => "┓",
        (Through, Right, Start, Plain) => "┓",
        (Through, Right, Start, Rounded) => "┓",
        (Through, Right, Start, Double) => "┓",
        (Through, Right, Start, Thick) => "┓",
        (Through, Right, Start, QuadrantInside) => "┓",
        (Through, Right, Start, QuadrantOutside) => "┓",
        (Through, Right, Pos(_), Plain) => "╂",
        (Through, Right, Pos(_), Rounded) => "╂",
        (Through, Right, Pos(_), Double) => "╋",
        (Through, Right, Pos(_), Thick) => "╋",
        (Through, Right, Pos(_), QuadrantInside) => "╋",
        (Through, Right, Pos(_), QuadrantOutside) => "╋",
        (Through, Right, End, Plain) => "┛",
        (Through, Right, End, Rounded) => "┛",
        (Through, Right, End, Double) => "┛",
        (Through, Right, End, Thick) => "┛",
        (Through, Right, End, QuadrantInside) => "┛",
        (Through, Right, End, QuadrantOutside) => "┛",
        (Through, Right, ProlongEnd, Plain) => "┛",
        (Through, Right, ProlongEnd, Rounded) => "┛",
        (Through, Right, ProlongEnd, Double) => "┛",
        (Through, Right, ProlongEnd, Thick) => "┛",
        (Through, Right, ProlongEnd, QuadrantInside) => "┛",
        (Through, Right, ProlongEnd, QuadrantOutside) => "┛",

        (Through, Bottom, ProlongStart, Plain) => "┗",
        (Through, Bottom, ProlongStart, Rounded) => "┗",
        (Through, Bottom, ProlongStart, Double) => "┗",
        (Through, Bottom, ProlongStart, Thick) => "┗",
        (Through, Bottom, ProlongStart, QuadrantInside) => "┗",
        (Through, Bottom, ProlongStart, QuadrantOutside) => "┗",
        (Through, Bottom, Start, Plain) => "┗",
        (Through, Bottom, Start, Rounded) => "┗",
        (Through, Bottom, Start, Double) => "┗",
        (Through, Bottom, Start, Thick) => "┗",
        (Through, Bottom, Start, QuadrantInside) => "┗",
        (Through, Bottom, Start, QuadrantOutside) => "┗",
        (Through, Bottom, Pos(_), Plain) => "┿",
        (Through, Bottom, Pos(_), Rounded) => "┿",
        (Through, Bottom, Pos(_), Double) => "╋",
        (Through, Bottom, Pos(_), Thick) => "╋",
        (Through, Bottom, Pos(_), QuadrantInside) => "╋",
        (Through, Bottom, Pos(_), QuadrantOutside) => "╋",
        (Through, Bottom, End, Plain) => "┛",
        (Through, Bottom, End, Rounded) => "┛",
        (Through, Bottom, End, Double) => "┛",
        (Through, Bottom, End, Thick) => "┛",
        (Through, Bottom, End, QuadrantInside) => "┛",
        (Through, Bottom, End, QuadrantOutside) => "┛",
        (Through, Bottom, ProlongEnd, Plain) => "┛",
        (Through, Bottom, ProlongEnd, Rounded) => "┛",
        (Through, Bottom, ProlongEnd, Double) => "┛",
        (Through, Bottom, ProlongEnd, Thick) => "┛",
        (Through, Bottom, ProlongEnd, QuadrantInside) => "┛",
        (Through, Bottom, ProlongEnd, QuadrantOutside) => "┛",

        (Through, Left, ProlongStart, Plain) => "┏",
        (Through, Left, ProlongStart, Rounded) => "┏",
        (Through, Left, ProlongStart, Double) => "┏",
        (Through, Left, ProlongStart, Thick) => "┏",
        (Through, Left, ProlongStart, QuadrantInside) => "┏",
        (Through, Left, ProlongStart, QuadrantOutside) => "┏",
        (Through, Left, Start, Plain) => "┏",
        (Through, Left, Start, Rounded) => "┏",
        (Through, Left, Start, Double) => "┏",
        (Through, Left, Start, Thick) => "┏",
        (Through, Left, Start, QuadrantInside) => "┏",
        (Through, Left, Start, QuadrantOutside) => "┏",
        (Through, Left, Pos(_), Plain) => "╂",
        (Through, Left, Pos(_), Rounded) => "╂",
        (Through, Left, Pos(_), Double) => "╋",
        (Through, Left, Pos(_), Thick) => "╋",
        (Through, Left, Pos(_), QuadrantInside) => "╋",
        (Through, Left, Pos(_), QuadrantOutside) => "╋",
        (Through, Left, End, Plain) => "┗",
        (Through, Left, End, Rounded) => "┗",
        (Through, Left, End, Double) => "┗",
        (Through, Left, End, Thick) => "┗",
        (Through, Left, End, QuadrantInside) => "┗",
        (Through, Left, End, QuadrantOutside) => "┗",
        (Through, Left, ProlongEnd, Plain) => "┗",
        (Through, Left, ProlongEnd, Rounded) => "┗",
        (Through, Left, ProlongEnd, Double) => "┗",
        (Through, Left, ProlongEnd, Thick) => "┗",
        (Through, Left, ProlongEnd, QuadrantInside) => "┗",
        (Through, Left, ProlongEnd, QuadrantOutside) => "┗",

        (Manual(cc), _, _, _) => cc,
    }
}

fn quad_inside_joint(joint: Joint) -> &'static str {
    use BorderType::*;
    use JointPos::*;
    use JointScale::*;
    use JointSide::*;

    match (joint.scale, joint.side, joint.pos, joint.border) {
        (Out, Top, ProlongStart, Plain) => "▄",
        (Out, Top, ProlongStart, Rounded) => "▄",
        (Out, Top, ProlongStart, Double) => "▄",
        (Out, Top, ProlongStart, Thick) => "▄",
        (Out, Top, ProlongStart, QuadrantInside) => "▄",
        (Out, Top, ProlongStart, QuadrantOutside) => "▄",
        (Out, Top, Start, Plain) => "▐",
        (Out, Top, Start, Rounded) => "▐",
        (Out, Top, Start, Double) => "▐",
        (Out, Top, Start, Thick) => "▐",
        (Out, Top, Start, QuadrantInside) => "▐",
        (Out, Top, Start, QuadrantOutside) => "▐",
        (Out, Top, Pos(_), Plain) => "┴",
        (Out, Top, Pos(_), Rounded) => "┴",
        (Out, Top, Pos(_), Double) => "╨",
        (Out, Top, Pos(_), Thick) => "┸",
        (Out, Top, Pos(_), QuadrantInside) => "X",
        (Out, Top, Pos(_), QuadrantOutside) => "X",
        (Out, Top, End, Plain) => "┤",
        (Out, Top, End, Rounded) => "┤",
        (Out, Top, End, Double) => "┤",
        (Out, Top, End, Thick) => "┦",
        (Out, Top, End, QuadrantInside) => "X",
        (Out, Top, End, QuadrantOutside) => "X",
        (Out, Top, ProlongEnd, Plain) => "┬",
        (Out, Top, ProlongEnd, Rounded) => "┬",
        (Out, Top, ProlongEnd, Double) => "┬",
        (Out, Top, ProlongEnd, Thick) => "┮",
        (Out, Top, ProlongEnd, QuadrantInside) => "X",
        (Out, Top, ProlongEnd, QuadrantOutside) => "X",

        (Out, Right, ProlongStart, Plain) => "┤",
        (Out, Right, ProlongStart, Rounded) => "┤",
        (Out, Right, ProlongStart, Double) => "┤",
        (Out, Right, ProlongStart, Thick) => "┦",
        (Out, Right, ProlongStart, QuadrantInside) => "X",
        (Out, Right, ProlongStart, QuadrantOutside) => "X",
        (Out, Right, Start, Plain) => "┬",
        (Out, Right, Start, Rounded) => "┬",
        (Out, Right, Start, Double) => "┬",
        (Out, Right, Start, Thick) => "┮",
        (Out, Right, Start, QuadrantInside) => "X",
        (Out, Right, Start, QuadrantOutside) => "X",
        (Out, Right, Pos(_), Plain) => "├",
        (Out, Right, Pos(_), Rounded) => "├",
        (Out, Right, Pos(_), Double) => "╞",
        (Out, Right, Pos(_), Thick) => "┝",
        (Out, Right, Pos(_), QuadrantInside) => "X",
        (Out, Right, Pos(_), QuadrantOutside) => "X",
        (Out, Right, End, Plain) => "┴",
        (Out, Right, End, Rounded) => "┴",
        (Out, Right, End, Double) => "┴",
        (Out, Right, End, Thick) => "┶",
        (Out, Right, End, QuadrantInside) => "X",
        (Out, Right, End, QuadrantOutside) => "X",
        (Out, Right, ProlongEnd, Plain) => "┤",
        (Out, Right, ProlongEnd, Rounded) => "┤",
        (Out, Right, ProlongEnd, Double) => "┤",
        (Out, Right, ProlongEnd, Thick) => "┧",
        (Out, Right, ProlongEnd, QuadrantInside) => "X",
        (Out, Right, ProlongEnd, QuadrantOutside) => "X",

        (Out, Bottom, ProlongStart, Plain) => "┴",
        (Out, Bottom, ProlongStart, Rounded) => "┴",
        (Out, Bottom, ProlongStart, Double) => "┴",
        (Out, Bottom, ProlongStart, Thick) => "┵",
        (Out, Bottom, ProlongStart, QuadrantInside) => "X",
        (Out, Bottom, ProlongStart, QuadrantOutside) => "X",
        (Out, Bottom, Start, Plain) => "├",
        (Out, Bottom, Start, Rounded) => "├",
        (Out, Bottom, Start, Double) => "├",
        (Out, Bottom, Start, Thick) => "┟",
        (Out, Bottom, Start, QuadrantInside) => "X",
        (Out, Bottom, Start, QuadrantOutside) => "X",
        (Out, Bottom, Pos(_), Plain) => "┬",
        (Out, Bottom, Pos(_), Rounded) => "┬",
        (Out, Bottom, Pos(_), Double) => "╥",
        (Out, Bottom, Pos(_), Thick) => "┰",
        (Out, Bottom, Pos(_), QuadrantInside) => "X",
        (Out, Bottom, Pos(_), QuadrantOutside) => "X",
        (Out, Bottom, End, Plain) => "┤",
        (Out, Bottom, End, Rounded) => "┤",
        (Out, Bottom, End, Double) => "┤",
        (Out, Bottom, End, Thick) => "┧",
        (Out, Bottom, End, QuadrantInside) => "X",
        (Out, Bottom, End, QuadrantOutside) => "X",
        (Out, Bottom, ProlongEnd, Plain) => "┴",
        (Out, Bottom, ProlongEnd, Rounded) => "┴",
        (Out, Bottom, ProlongEnd, Double) => "┴",
        (Out, Bottom, ProlongEnd, Thick) => "┶",
        (Out, Bottom, ProlongEnd, QuadrantInside) => "X",
        (Out, Bottom, ProlongEnd, QuadrantOutside) => "X",

        (Out, Left, ProlongStart, Plain) => "├",
        (Out, Left, ProlongStart, Rounded) => "├",
        (Out, Left, ProlongStart, Double) => "├",
        (Out, Left, ProlongStart, Thick) => "┞",
        (Out, Left, ProlongStart, QuadrantInside) => "X",
        (Out, Left, ProlongStart, QuadrantOutside) => "X",
        (Out, Left, Start, Plain) => "┬",
        (Out, Left, Start, Rounded) => "┬",
        (Out, Left, Start, Double) => "┬",
        (Out, Left, Start, Thick) => "┭",
        (Out, Left, Start, QuadrantInside) => "X",
        (Out, Left, Start, QuadrantOutside) => "X",
        (Out, Left, Pos(_), Plain) => "┤",
        (Out, Left, Pos(_), Rounded) => "┤",
        (Out, Left, Pos(_), Double) => "╡",
        (Out, Left, Pos(_), Thick) => "┥",
        (Out, Left, Pos(_), QuadrantInside) => "X",
        (Out, Left, Pos(_), QuadrantOutside) => "X",
        (Out, Left, End, Plain) => "┴",
        (Out, Left, End, Rounded) => "┴",
        (Out, Left, End, Double) => "┴",
        (Out, Left, End, Thick) => "┵",
        (Out, Left, End, QuadrantInside) => "X",
        (Out, Left, End, QuadrantOutside) => "X",
        (Out, Left, ProlongEnd, Plain) => "├",
        (Out, Left, ProlongEnd, Rounded) => "├",
        (Out, Left, ProlongEnd, Double) => "├",
        (Out, Left, ProlongEnd, Thick) => "┟",
        (Out, Left, ProlongEnd, QuadrantInside) => "X",
        (Out, Left, ProlongEnd, QuadrantOutside) => "X",

        // ----------------------------------------------
        (In, Top, ProlongStart, Plain) => "┌",
        (In, Top, ProlongStart, Rounded) => "┌",
        (In, Top, ProlongStart, Double) => "┌",
        (In, Top, ProlongStart, Thick) => "┌",
        (In, Top, ProlongStart, QuadrantInside) => "X",
        (In, Top, ProlongStart, QuadrantOutside) => "X",
        (In, Top, Start, Plain) => "┌",
        (In, Top, Start, Rounded) => "┌",
        (In, Top, Start, Double) => "┌",
        (In, Top, Start, Thick) => "┌",
        (In, Top, Start, QuadrantInside) => "X",
        (In, Top, Start, QuadrantOutside) => "X",
        (In, Top, Pos(_), Plain) => "┬",
        (In, Top, Pos(_), Rounded) => "┬",
        (In, Top, Pos(_), Double) => "╥",
        (In, Top, Pos(_), Thick) => "┰",
        (In, Top, Pos(_), QuadrantInside) => "X",
        (In, Top, Pos(_), QuadrantOutside) => "X",
        (In, Top, End, Plain) => "┐",
        (In, Top, End, Rounded) => "┐",
        (In, Top, End, Double) => "┐",
        (In, Top, End, Thick) => "┐",
        (In, Top, End, QuadrantInside) => "X",
        (In, Top, End, QuadrantOutside) => "X",
        (In, Top, ProlongEnd, Plain) => "┐",
        (In, Top, ProlongEnd, Rounded) => "┐",
        (In, Top, ProlongEnd, Double) => "┐",
        (In, Top, ProlongEnd, Thick) => "┐",
        (In, Top, ProlongEnd, QuadrantInside) => "X",
        (In, Top, ProlongEnd, QuadrantOutside) => "X",

        (In, Right, ProlongStart, Plain) => "┐",
        (In, Right, ProlongStart, Rounded) => "┐",
        (In, Right, ProlongStart, Double) => "┐",
        (In, Right, ProlongStart, Thick) => "┐",
        (In, Right, ProlongStart, QuadrantInside) => "X",
        (In, Right, ProlongStart, QuadrantOutside) => "X",
        (In, Right, Start, Plain) => "┐",
        (In, Right, Start, Rounded) => "┐",
        (In, Right, Start, Double) => "┐",
        (In, Right, Start, Thick) => "┐",
        (In, Right, Start, QuadrantInside) => "X",
        (In, Right, Start, QuadrantOutside) => "X",
        (In, Right, Pos(_), Plain) => "┤",
        (In, Right, Pos(_), Rounded) => "┤",
        (In, Right, Pos(_), Double) => "╡",
        (In, Right, Pos(_), Thick) => "┥",
        (In, Right, Pos(_), QuadrantInside) => "X",
        (In, Right, Pos(_), QuadrantOutside) => "X",
        (In, Right, End, Plain) => "┘",
        (In, Right, End, Rounded) => "┘",
        (In, Right, End, Double) => "┘",
        (In, Right, End, Thick) => "┘",
        (In, Right, End, QuadrantInside) => "X",
        (In, Right, End, QuadrantOutside) => "X",
        (In, Right, ProlongEnd, Plain) => "┘",
        (In, Right, ProlongEnd, Rounded) => "┘",
        (In, Right, ProlongEnd, Double) => "┘",
        (In, Right, ProlongEnd, Thick) => "┘",
        (In, Right, ProlongEnd, QuadrantInside) => "X",
        (In, Right, ProlongEnd, QuadrantOutside) => "X",

        (In, Bottom, ProlongStart, Plain) => "└",
        (In, Bottom, ProlongStart, Rounded) => "└",
        (In, Bottom, ProlongStart, Double) => "└",
        (In, Bottom, ProlongStart, Thick) => "└",
        (In, Bottom, ProlongStart, QuadrantInside) => "X",
        (In, Bottom, ProlongStart, QuadrantOutside) => "X",
        (In, Bottom, Start, Plain) => "└",
        (In, Bottom, Start, Rounded) => "└",
        (In, Bottom, Start, Double) => "└",
        (In, Bottom, Start, Thick) => "└",
        (In, Bottom, Start, QuadrantInside) => "X",
        (In, Bottom, Start, QuadrantOutside) => "X",
        (In, Bottom, Pos(_), Plain) => "┴",
        (In, Bottom, Pos(_), Rounded) => "┴",
        (In, Bottom, Pos(_), Double) => "╨",
        (In, Bottom, Pos(_), Thick) => "┸",
        (In, Bottom, Pos(_), QuadrantInside) => "X",
        (In, Bottom, Pos(_), QuadrantOutside) => "X",
        (In, Bottom, End, Plain) => "┘",
        (In, Bottom, End, Rounded) => "┘",
        (In, Bottom, End, Double) => "┘",
        (In, Bottom, End, Thick) => "┘",
        (In, Bottom, End, QuadrantInside) => "X",
        (In, Bottom, End, QuadrantOutside) => "X",
        (In, Bottom, ProlongEnd, Plain) => "┘",
        (In, Bottom, ProlongEnd, Rounded) => "┘",
        (In, Bottom, ProlongEnd, Double) => "┘",
        (In, Bottom, ProlongEnd, Thick) => "┘",
        (In, Bottom, ProlongEnd, QuadrantInside) => "X",
        (In, Bottom, ProlongEnd, QuadrantOutside) => "X",

        (In, Left, ProlongStart, Plain) => "┌",
        (In, Left, ProlongStart, Rounded) => "┌",
        (In, Left, ProlongStart, Double) => "┌",
        (In, Left, ProlongStart, Thick) => "┌",
        (In, Left, ProlongStart, QuadrantInside) => "X",
        (In, Left, ProlongStart, QuadrantOutside) => "X",
        (In, Left, Start, Plain) => "┌",
        (In, Left, Start, Rounded) => "┌",
        (In, Left, Start, Double) => "┌",
        (In, Left, Start, Thick) => "┌",
        (In, Left, Start, QuadrantInside) => "X",
        (In, Left, Start, QuadrantOutside) => "X",
        (In, Left, Pos(_), Plain) => "├",
        (In, Left, Pos(_), Rounded) => "├",
        (In, Left, Pos(_), Double) => "╞",
        (In, Left, Pos(_), Thick) => "┝",
        (In, Left, Pos(_), QuadrantInside) => "X",
        (In, Left, Pos(_), QuadrantOutside) => "X",
        (In, Left, End, Plain) => "└",
        (In, Left, End, Rounded) => "└",
        (In, Left, End, Double) => "└",
        (In, Left, End, Thick) => "└",
        (In, Left, End, QuadrantInside) => "X",
        (In, Left, End, QuadrantOutside) => "X",
        (In, Left, ProlongEnd, Plain) => "└",
        (In, Left, ProlongEnd, Rounded) => "└",
        (In, Left, ProlongEnd, Double) => "└",
        (In, Left, ProlongEnd, Thick) => "└",
        (In, Left, ProlongEnd, QuadrantInside) => "X",
        (In, Left, ProlongEnd, QuadrantOutside) => "X",

        // ----------------------------------------------
        (Through, Top, ProlongStart, Plain) => "┌",
        (Through, Top, ProlongStart, Rounded) => "┌",
        (Through, Top, ProlongStart, Double) => "┌",
        (Through, Top, ProlongStart, Thick) => "┌",
        (Through, Top, ProlongStart, QuadrantInside) => "X",
        (Through, Top, ProlongStart, QuadrantOutside) => "X",
        (Through, Top, Start, Plain) => "┌",
        (Through, Top, Start, Rounded) => "┌",
        (Through, Top, Start, Double) => "┌",
        (Through, Top, Start, Thick) => "┌",
        (Through, Top, Start, QuadrantInside) => "X",
        (Through, Top, Start, QuadrantOutside) => "X",
        (Through, Top, Pos(_), Plain) => "┼",
        (Through, Top, Pos(_), Rounded) => "┼",
        (Through, Top, Pos(_), Double) => "╫",
        (Through, Top, Pos(_), Thick) => "╂",
        (Through, Top, Pos(_), QuadrantInside) => "X",
        (Through, Top, Pos(_), QuadrantOutside) => "X",
        (Through, Top, End, Plain) => "┐",
        (Through, Top, End, Rounded) => "┐",
        (Through, Top, End, Double) => "┐",
        (Through, Top, End, Thick) => "┐",
        (Through, Top, End, QuadrantInside) => "X",
        (Through, Top, End, QuadrantOutside) => "X",
        (Through, Top, ProlongEnd, Plain) => "┐",
        (Through, Top, ProlongEnd, Rounded) => "┐",
        (Through, Top, ProlongEnd, Double) => "┐",
        (Through, Top, ProlongEnd, Thick) => "┐",
        (Through, Top, ProlongEnd, QuadrantInside) => "X",
        (Through, Top, ProlongEnd, QuadrantOutside) => "X",

        (Through, Right, ProlongStart, Plain) => "┐",
        (Through, Right, ProlongStart, Rounded) => "┐",
        (Through, Right, ProlongStart, Double) => "┐",
        (Through, Right, ProlongStart, Thick) => "┐",
        (Through, Right, ProlongStart, QuadrantInside) => "X",
        (Through, Right, ProlongStart, QuadrantOutside) => "X",
        (Through, Right, Start, Plain) => "┐",
        (Through, Right, Start, Rounded) => "┐",
        (Through, Right, Start, Double) => "┐",
        (Through, Right, Start, Thick) => "┐",
        (Through, Right, Start, QuadrantInside) => "X",
        (Through, Right, Start, QuadrantOutside) => "X",
        (Through, Right, Pos(_), Plain) => "┼",
        (Through, Right, Pos(_), Rounded) => "┼",
        (Through, Right, Pos(_), Double) => "╪",
        (Through, Right, Pos(_), Thick) => "┿",
        (Through, Right, Pos(_), QuadrantInside) => "X",
        (Through, Right, Pos(_), QuadrantOutside) => "X",
        (Through, Right, End, Plain) => "┘",
        (Through, Right, End, Rounded) => "┘",
        (Through, Right, End, Double) => "┘",
        (Through, Right, End, Thick) => "┘",
        (Through, Right, End, QuadrantInside) => "X",
        (Through, Right, End, QuadrantOutside) => "X",
        (Through, Right, ProlongEnd, Plain) => "┘",
        (Through, Right, ProlongEnd, Rounded) => "┘",
        (Through, Right, ProlongEnd, Double) => "┘",
        (Through, Right, ProlongEnd, Thick) => "┘",
        (Through, Right, ProlongEnd, QuadrantInside) => "X",
        (Through, Right, ProlongEnd, QuadrantOutside) => "X",

        (Through, Bottom, ProlongStart, Plain) => "└",
        (Through, Bottom, ProlongStart, Rounded) => "└",
        (Through, Bottom, ProlongStart, Double) => "└",
        (Through, Bottom, ProlongStart, Thick) => "└",
        (Through, Bottom, ProlongStart, QuadrantInside) => "X",
        (Through, Bottom, ProlongStart, QuadrantOutside) => "X",
        (Through, Bottom, Start, Plain) => "└",
        (Through, Bottom, Start, Rounded) => "└",
        (Through, Bottom, Start, Double) => "└",
        (Through, Bottom, Start, Thick) => "└",
        (Through, Bottom, Start, QuadrantInside) => "X",
        (Through, Bottom, Start, QuadrantOutside) => "X",
        (Through, Bottom, Pos(_), Plain) => "┼",
        (Through, Bottom, Pos(_), Rounded) => "┼",
        (Through, Bottom, Pos(_), Double) => "╫",
        (Through, Bottom, Pos(_), Thick) => "╂",
        (Through, Bottom, Pos(_), QuadrantInside) => "X",
        (Through, Bottom, Pos(_), QuadrantOutside) => "X",
        (Through, Bottom, End, Plain) => "┘",
        (Through, Bottom, End, Rounded) => "┘",
        (Through, Bottom, End, Double) => "┘",
        (Through, Bottom, End, Thick) => "┘",
        (Through, Bottom, End, QuadrantInside) => "X",
        (Through, Bottom, End, QuadrantOutside) => "X",
        (Through, Bottom, ProlongEnd, Plain) => "┘",
        (Through, Bottom, ProlongEnd, Rounded) => "┘",
        (Through, Bottom, ProlongEnd, Double) => "┘",
        (Through, Bottom, ProlongEnd, Thick) => "┘",
        (Through, Bottom, ProlongEnd, QuadrantInside) => "X",
        (Through, Bottom, ProlongEnd, QuadrantOutside) => "X",

        (Through, Left, ProlongStart, Plain) => "┌",
        (Through, Left, ProlongStart, Rounded) => "┌",
        (Through, Left, ProlongStart, Double) => "┌",
        (Through, Left, ProlongStart, Thick) => "┌",
        (Through, Left, ProlongStart, QuadrantInside) => "X",
        (Through, Left, ProlongStart, QuadrantOutside) => "X",
        (Through, Left, Start, Plain) => "┌",
        (Through, Left, Start, Rounded) => "┌",
        (Through, Left, Start, Double) => "┌",
        (Through, Left, Start, Thick) => "┌",
        (Through, Left, Start, QuadrantInside) => "X",
        (Through, Left, Start, QuadrantOutside) => "X",
        (Through, Left, Pos(_), Plain) => "┼",
        (Through, Left, Pos(_), Rounded) => "┼",
        (Through, Left, Pos(_), Double) => "╪",
        (Through, Left, Pos(_), Thick) => "┿",
        (Through, Left, Pos(_), QuadrantInside) => "X",
        (Through, Left, Pos(_), QuadrantOutside) => "X",
        (Through, Left, End, Plain) => "└",
        (Through, Left, End, Rounded) => "└",
        (Through, Left, End, Double) => "└",
        (Through, Left, End, Thick) => "└",
        (Through, Left, End, QuadrantInside) => "X",
        (Through, Left, End, QuadrantOutside) => "X",
        (Through, Left, ProlongEnd, Plain) => "└",
        (Through, Left, ProlongEnd, Rounded) => "└",
        (Through, Left, ProlongEnd, Double) => "└",
        (Through, Left, ProlongEnd, Thick) => "└",
        (Through, Left, ProlongEnd, QuadrantInside) => "X",
        (Through, Left, ProlongEnd, QuadrantOutside) => "X",

        (Manual(cc), _, _, _) => cc,
    }
}
